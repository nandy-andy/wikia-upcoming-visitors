<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Wikia-upcoming-visitors : A simple application which retrieves data from Google Calendar and returns messages about upcoming visitors">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Wikia-upcoming-visitors</title>
    
    <script src="https://apis.google.com/js/client.js"></script>
    <script>
      function auth() {
        var config = {
          'client_id': '671827949894-b6eoa7u39g5cpecn0n42h2vqgh8sv0au.apps.googleusercontent.com',
          'scope': 'https://www.googleapis.com/auth/calendar.readonly'
        };
        gapi.auth.authorize(config, function(authResult) {
          var results = document.getElementById('results');
              
          if (authResult && !authResult.error) {
            getCalendarEvents();
          } else {
            results.appendChild(document.createTextNode('Authentication error occured.'));
          }
        });
      }
      
      function getCalendarEvents() {
        gapi.client.load('calendar', 'v3', function() {
          var request = gapi.client.calendar.events.list({
            'calendarId': 'wikia-inc.com_4ch01et6e58vbfr2on5575alu8@group.calendar.google.com',
            'timeMin': '2014-12-01T00:00:00.000Z',
            'timeMax': '2014-12-31T23:59:59.000Z'
          });
          
          request.execute(function(resp) {
            var results = document.getElementById('results');
            
            if( resp.items ) {
              resp.items.forEach(function(event) {
                var p = document.createElement('p'),
                    sorted,
                    matches;
                
                matches = event.summary.matches("(.{1,}) in (.{1,})");
                if( matches ) {
                  console.log(event);
                  p.appendChild(document.createTextNode(event.summary));
                  results.appendChild(p);
                }
              });
            }
            
            results.appendChild(document.createTextNode(JSON.stringify(resp)));
          });
        });
      
      }
    </script>
  </head>

  <body onload="auth();">

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/nandy-andy/wikia-upcoming-visitors">View on GitHub</a>

          <h1 id="project_title">Wikia-upcoming-visitors</h1>
          <h2 id="project_tagline">A simple application which retrieves data from Google Calendar and returns messages about upcoming visitors</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/nandy-andy/wikia-upcoming-visitors/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/nandy-andy/wikia-upcoming-visitors/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <div id="results"></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Wikia-upcoming-visitors maintained by <a href="https://github.com/nandy-andy">nandy-andy</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
